@page "/scoreboard/teammatch-live"
@using System.Threading
@using System.Linq
@using Client.Palaro2026.Services
@inject APIService apiService
@inject NavigationManager Navigation
@implements IDisposable
@layout NoMainLayout

<PageTitle>Team Match Dashboard | PALARO 2026</PageTitle>

<style>
    @@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@500;600;700&family=Chakra+Petch:wght@600;700&display=swap');

    :root {
        --bg-dark: #0a0a0a;
        --card-bg: rgba(30, 30, 30, 0.7);
        --card-border: rgba(255, 255, 255, 0.1);
        --text-primary: #ffffff;
        --accent-blue: #00e5ff;
        --accent-gold: #FFD700;
        --accent-red: #ff1744;
        --neon-gold: 0 0 10px rgba(255, 215, 0, 0.6), 0 0 20px rgba(255, 215, 0, 0.3);
        --neon-blue: 0 0 10px rgba(0, 229, 255, 0.6);
    }

    /* BACKGROUND TEXTURE */
    .dashboard-bg {
        background-color: var(--bg-dark);
        background-image: radial-gradient(circle at 10% 20%, rgba(41, 121, 255, 0.08) 0%, transparent 40%), radial-gradient(circle at 90% 80%, rgba(255, 23, 68, 0.05) 0%, transparent 40%), linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
        background-size: 100% 100%, 100% 100%, 40px 40px, 40px 40px;
        min-height: 100vh;
        color: var(--text-primary);
        font-family: 'Rajdhani', sans-serif;
    }

    /* HEADER */
    .header-container {
        text-align: center;
        margin-bottom: 40px;
        position: relative;
        padding: 30px 0;
        background: linear-gradient(180deg, rgba(0,0,0,0.6) 0%, transparent 100%);
        border-bottom: 1px solid rgba(255, 215, 0, 0.2);
    }

    .main-title {
        font-family: 'Orbitron', sans-serif;
        font-weight: 900;
        font-size: clamp(2rem, 5vw, 3.5rem);
        background: linear-gradient(180deg, #FFD700 0%, #FDB931 50%, #9C7C18 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: 4px;
        text-transform: uppercase;
        margin-bottom: 5px;
        filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4));
    }

    .sub-title {
        font-family: 'Chakra Petch', sans-serif;
        color: rgba(255, 255, 255, 0.7);
        font-size: clamp(1rem, 1.5vw, 1.3rem);
        letter-spacing: 8px;
        font-weight: 700;
        text-transform: uppercase;
        position: relative;
        display: inline-block;
    }

        .sub-title::before, .sub-title::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 60px;
            height: 2px;
            background: var(--accent-gold);
            opacity: 0.5;
        }

        .sub-title::before {
            left: -80px;
        }

        .sub-title::after {
            right: -80px;
        }

    /* CARD DESIGN */
    .match-link {
        text-decoration: none;
        display: block;
        height: 100%;
    }

    .match-card {
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: 20px;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(10px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        height: 100%;
    }

        .match-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);
            opacity: 0.5;
        }

        .match-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--accent-blue);
            box-shadow: 0 15px 40px rgba(0, 229, 255, 0.15);
        }

            .match-card:hover::before {
                opacity: 1;
            }

    /* SCORES */
    .score-big {
        font-family: 'Orbitron', sans-serif;
        font-size: 3.8rem;
        font-weight: 900;
        line-height: 1;
        text-shadow: 0 0 20px rgba(0,0,0,0.8);
        transition: color 0.3s ease;
    }

    .score-label {
        font-family: 'Chakra Petch', sans-serif;
        font-size: 0.8rem;
        font-weight: 600;
        color: #888;
        letter-spacing: 2px;
        text-transform: uppercase;
    }

    .team-abbr {
        font-family: 'Orbitron', sans-serif;
        font-size: 1.8rem;
        font-weight: 800;
        letter-spacing: 1px;
        margin-top: 10px;
        color: white;
    }

    /* VS SEPARATOR */
    .vs-container {
        position: relative;
        width: 40px;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .vs-line {
        position: absolute;
        width: 2px;
        height: 100%;
        background: linear-gradient(to bottom, transparent, #444, transparent);
        transform: rotate(15deg);
    }

    .vs-text {
        font-family: 'Orbitron', sans-serif;
        font-style: italic;
        color: rgba(255,255,255,0.2);
        font-weight: 900;
        font-size: 1.5rem;
    }

    /* BADGES */
    .status-container {
        position: absolute;
        top: 15px;
        right: 15px;
        display: flex;
        gap: 8px;
        z-index: 5;
    }

    .phase-badge {
        background: rgba(0,0,0,0.8);
        color: var(--accent-gold);
        padding: 4px 12px;
        border-radius: 6px;
        font-family: 'Chakra Petch';
        font-weight: 700;
        font-size: 0.8rem;
        border: 1px solid var(--accent-gold);
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
    }

    .status-badge {
        padding: 4px 15px;
        border-radius: 6px;
        font-family: 'Chakra Petch';
        font-weight: 800;
        font-size: 0.8rem;
        letter-spacing: 1px;
    }

    .badge-live {
        background: linear-gradient(135deg, #ff0000 0%, #b30000 100%);
        color: white;
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        border: 1px solid #ff5252;
        animation: pulse 2s infinite;
    }

    .badge-final {
        background: linear-gradient(135deg, #00C853 0%, #00695C 100%);
        color: white;
        border: 1px solid #69F0AE;
    }

    /* WINNER INDICATOR */
    .winner-tag {
        background: var(--accent-gold);
        color: #000;
        font-family: 'Orbitron', sans-serif;
        font-size: 0.7rem;
        font-weight: 900;
        padding: 3px 12px;
        border-radius: 20px;
        margin-bottom: 8px;
        box-shadow: var(--neon-gold);
        letter-spacing: 1px;
        animation: slide-down 0.4s ease-out;
    }

    @@keyframes slide-down {
        from {
            transform: translateY(-10px);
            opacity: 0;
        }

        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    @@keyframes pulse {
        0% {
            opacity: 1;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        }

        50% {
            opacity: 0.8;
            box-shadow: 0 0 5px rgba(255, 0, 0, 0.2);
        }

        100% {
            opacity: 1;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        }
    }

    .logo-circle {
        width: 90px;
        height: 90px;
        background: radial-gradient(circle, #2a2a2a 0%, #151515 100%);
        border-radius: 50%;
        padding: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #333;
        transition: all 0.3s ease;
        position: relative;
    }

    /* Winner Logo Glow */
    .winner-border {
        border-color: var(--accent-gold) !important;
        box-shadow: var(--neon-gold);
        transform: scale(1.05);
    }

    .sport-icon {
        background: linear-gradient(135deg, rgba(41, 121, 255, 0.2), rgba(41, 121, 255, 0.05));
        border-radius: 50%;
        padding: 10px;
        border: 1px solid rgba(41, 121, 255, 0.3);
    }

    /* MUD TABS CUSTOMIZATION */
    .mud-tabs-tabbar {
        background-color: transparent !important;
        border-bottom: 1px solid #333;
    }

    .mud-tab {
        color: #888 !important;
        font-family: 'Orbitron';
        font-weight: 700;
        letter-spacing: 1px;
        transition: color 0.3s;
    }

    .mud-tab-active {
        color: var(--accent-blue) !important;
        font-weight: 900;
        text-shadow: 0 0 10px rgba(0, 229, 255, 0.4);
    }

    .mud-tabs-indicator {
        background-color: var(--accent-blue) !important;
        height: 3px;
        box-shadow: 0 0 10px var(--accent-blue);
    }
</style>

<div class="dashboard-bg">
    <MudContainer MaxWidth="MaxWidth.ExtraLarge">

        <!-- HEADER -->
        <div class="header-container">
            <div class="main-title">PALARONG PAMBANSA 2026</div>
            <div class="sub-title">TEAM MATCH SCOREBOARD</div>
        </div>

        @if (_isLoading)
        {
            <MudStack AlignItems="AlignItems.Center" Class="mt-16">
                <MudProgressCircular Indeterminate="true" Color="Color.Info" Size="Size.Large" />
                <MudText Typo="Typo.h6" Class="mt-4" Style="font-family:'Orbitron'; color:var(--accent-blue);">INITIALIZING DATA STREAM...</MudText>
            </MudStack>
        }
        else
        {
            <MudTabs Elevation="0" Rounded="true" ApplyEffectsToContainer="true" PanelClass="mt-6" Centered="true">

                <!-- TAB 1: LIVE GAMES -->
                <MudTabPanel Text="LIVE / ONGOING">
                    @if (!_versusEvents.Any(e => e.IsFinished != true))
                    {
                        <MudPaper Class="pa-16 d-flex flex-column align-center justify-center mt-4" Style="background-color: rgba(30,30,30,0.5); border: 1px dashed #444; border-radius: 20px;">
                            <MudIcon Icon="@Icons.Material.Filled.WifiOff" Size="Size.Large" Style="color: #555; width: 60px; height: 60px;" />
                            <MudText Typo="Typo.h5" Class="mt-4" Style="color: #666; font-family:'Orbitron'; font-weight:700;">NO LIVE MATCHES</MudText>
                            <MudText Typo="Typo.body2" Style="color: #555;">Stand by for upcoming events</MudText>
                        </MudPaper>
                    }
                    else
                    {
                        <MudGrid Spacing="3">
                            @foreach (var evt in _versusEvents.Where(e => e.IsFinished != true))
                            {
                                <!-- START OF CARD LOGIC (LIVE) -->
                                var teamA = evt.EventVersusList![0];
                                var teamB = evt.EventVersusList![1];
                                bool isFinished = evt.IsFinished ?? false;
                                bool isSetGame = IsSetBasedSport(evt.Sport);

                                int displayScoreA = 0;
                                int displayScoreB = 0;

                                if (isSetGame)
                                {
                                    var setScores = CalculateSets(evt.ID, teamA.Region, teamB.Region, isFinished);
                                    displayScoreA = setScores.Item1;
                                    displayScoreB = setScores.Item2;
                                }
                                else
                                {
                                    displayScoreA = GetTeamTotalPoints(evt.ID, teamA.Region);
                                    displayScoreB = GetTeamTotalPoints(evt.ID, teamB.Region);
                                }

                                var scoreLabel = isSetGame ? "SETS" : "PTS";
                                string phaseText = GetCurrentGamePhase(evt.ID, evt.Sport, isFinished);

                                // Highlighting for Live Leader
                                var colorA = displayScoreA > displayScoreB ? "var(--accent-gold)" : "white";
                                var colorB = displayScoreB > displayScoreA ? "var(--accent-gold)" : "white";

                                <MudItem xs="12" md="6" lg="4" xl="4">
                                    <a href="/scoreboard/client/@evt.ID" target="_blank" class="match-link">
                                        <div class="match-card">
                                            <div class="status-container">
                                                @if (!string.IsNullOrEmpty(phaseText))
                                                {
                                                    <div class="phase-badge">@phaseText</div>
                                                }
                                                <div class="status-badge badge-live">LIVE</div>
                                            </div>

                                            <div class="pa-5">
                                                <!-- Sport Header -->
                                                <div class="d-flex align-center mb-4">
                                                    <div class="sport-icon mr-3"><MudIcon Icon="@GetSportIcon(evt.Sport)" Size="Size.Small" Style="color:var(--accent-blue);" /></div>
                                                    <div>
                                                        <MudText Typo="Typo.subtitle1" Style="font-family:'Orbitron'; font-weight:900; color:white; line-height:1.2;">@evt.Sport</MudText>
                                                        <MudText Typo="Typo.caption" Style="color:#aaa; font-family:'Rajdhani'; letter-spacing:1px; font-weight:600;">@evt.Gender • @evt.EventStage</MudText>
                                                    </div>
                                                </div>

                                                <MudDivider Class="mb-4" Style="border-color: rgba(255,255,255,0.1);" />

                                                <!-- Teams & Score Row -->
                                                <div class="d-flex justify-space-between align-center px-2">
                                                    <!-- TEAM A -->
                                                    <div class="d-flex flex-column align-center" style="flex:1;">
                                                        <div class="logo-circle">
                                                            <MudImage Src="@($"https://palarongpambansa2026.com/attachments/media/regions/team_logo/{teamA.Region}.webp")" ObjectFit="ObjectFit.Contain" Style="width:100%; height:100%;" />
                                                        </div>
                                                        <div class="team-abbr text-center">@teamA.Abbreviation</div>
                                                        <div class="score-big" style="color: @colorA;">@displayScoreA</div>
                                                        <div class="score-label">@scoreLabel</div>
                                                    </div>

                                                    <!-- VS -->
                                                    <div class="vs-container mx-1">
                                                        <div class="vs-line"></div>
                                                        <span class="vs-text">VS</span>
                                                    </div>

                                                    <!-- TEAM B -->
                                                    <div class="d-flex flex-column align-center" style="flex:1;">
                                                        <div class="logo-circle">
                                                            <MudImage Src="@($"https://palarongpambansa2026.com/attachments/media/regions/team_logo/{teamB.Region}.webp")" ObjectFit="ObjectFit.Contain" Style="width:100%; height:100%;" />
                                                        </div>
                                                        <div class="team-abbr text-center">@teamB.Abbreviation</div>
                                                        <div class="score-big" style="color: @colorB;">@displayScoreB</div>
                                                        <div class="score-label">@scoreLabel</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                </MudItem>
                            }
                        </MudGrid>
                    }
                </MudTabPanel>

                <!-- TAB 2: FINISHED GAMES -->
                <MudTabPanel Text="RECENT RESULTS">
                    @if (!_versusEvents.Any(e => e.IsFinished == true))
                    {
                        <MudPaper Class="pa-16 d-flex flex-column align-center justify-center mt-4" Style="background-color: rgba(30,30,30,0.5); border: 1px dashed #444; border-radius: 20px;">
                            <MudIcon Icon="@Icons.Material.Filled.HistoryToggleOff" Size="Size.Large" Style="color: #555;" />
                            <MudText Typo="Typo.h6" Class="mt-4" Style="color: #777; font-family:'Orbitron'">NO COMPLETED MATCHES YET</MudText>
                        </MudPaper>
                    }
                    else
                    {
                        <MudGrid Spacing="3">
                            @foreach (var evt in _versusEvents.Where(e => e.IsFinished == true))
                            {
                                <!-- START OF CARD LOGIC (FINISHED) -->
                                var teamA = evt.EventVersusList![0];
                                var teamB = evt.EventVersusList![1];
                                bool isFinished = evt.IsFinished ?? false;
                                bool isSetGame = IsSetBasedSport(evt.Sport);

                                int displayScoreA = 0;
                                int displayScoreB = 0;

                                if (isSetGame)
                                {
                                    var setScores = CalculateSets(evt.ID, teamA.Region, teamB.Region, isFinished);
                                    displayScoreA = setScores.Item1;
                                    displayScoreB = setScores.Item2;
                                }
                                else
                                {
                                    displayScoreA = GetTeamTotalPoints(evt.ID, teamA.Region);
                                    displayScoreB = GetTeamTotalPoints(evt.ID, teamB.Region);
                                }

                                var scoreLabel = isSetGame ? "SETS" : "PTS";

                                // WINNER LOGIC
                                bool isWinnerA = isFinished && displayScoreA > displayScoreB;
                                bool isWinnerB = isFinished && displayScoreB > displayScoreA;

                                var colorA = isWinnerA ? "var(--accent-gold)" : "white";
                                var colorB = isWinnerB ? "var(--accent-gold)" : "white";

                                <MudItem xs="12" md="6" lg="4" xl="4">
                                    <a href="/scoreboard/client/@evt.ID" target="_blank" class="match-link">
                                        <div class="match-card">
                                            <div class="status-container">
                                                <div class="status-badge badge-final">FINAL</div>
                                            </div>

                                            <div class="pa-5">
                                                <div class="d-flex align-center mb-4">
                                                    <div class="sport-icon mr-3"><MudIcon Icon="@GetSportIcon(evt.Sport)" Size="Size.Small" Style="color:var(--accent-blue);" /></div>
                                                    <div>
                                                        <MudText Typo="Typo.subtitle1" Style="font-family:'Orbitron'; font-weight:900; color:white; line-height:1.2;">@evt.Sport</MudText>
                                                        <MudText Typo="Typo.caption" Style="color:#888;">@evt.Gender • @evt.EventStage</MudText>
                                                    </div>
                                                </div>
                                                <MudDivider Class="mb-4" Style="border-color: rgba(255,255,255,0.1);" />
                                                <div class="d-flex justify-space-between align-center px-2">
                                                    <!-- TEAM A -->
                                                    <div class="d-flex flex-column align-center" style="flex:1;">
                                                        @if (isWinnerA)
                                                        {
                                                            <div class="winner-tag">WINNER</div>
                                                        }
                                                        <div class="logo-circle @(isWinnerA ? "winner-border" : "")">
                                                            <MudImage Src="@($"https://palarongpambansa2026.com/attachments/media/regions/team_logo/{teamA.Region}.webp")" ObjectFit="ObjectFit.Contain" Style="width:100%; height:100%;" />
                                                        </div>
                                                        <div class="team-abbr text-center">@teamA.Abbreviation</div>
                                                        <div class="score-big" style="color: @colorA;">@displayScoreA</div>
                                                        <div class="score-label">@scoreLabel</div>
                                                    </div>
                                                    <!-- VS -->
                                                    <div class="vs-container mx-1">
                                                        <div class="vs-line"></div>
                                                        <span class="vs-text">VS</span>
                                                    </div>
                                                    <!-- TEAM B -->
                                                    <div class="d-flex flex-column align-center" style="flex:1;">
                                                        @if (isWinnerB)
                                                        {
                                                            <div class="winner-tag">WINNER</div>
                                                        }
                                                        <div class="logo-circle @(isWinnerB ? "winner-border" : "")">
                                                            <MudImage Src="@($"https://palarongpambansa2026.com/attachments/media/regions/team_logo/{teamB.Region}.webp")" ObjectFit="ObjectFit.Contain" Style="width:100%; height:100%;" />
                                                        </div>
                                                        <div class="team-abbr text-center">@teamB.Abbreviation</div>
                                                        <div class="score-big" style="color: @colorB;">@displayScoreB</div>
                                                        <div class="score-label">@scoreLabel</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                </MudItem>
                            }
                        </MudGrid>
                    }
                </MudTabPanel>
            </MudTabs>
        }
    </MudContainer>
</div>

@code {
    // --- MODELS & VARIABLES ---
    public class EventModel
    {
        public string ID { get; set; } = "";
        public string? Sport { get; set; }
        public string? Gender { get; set; }
        public string? EventStage { get; set; }
        public bool? IsFinished { get; set; }
        public List<EventVersusTeams>? EventVersusList { get; set; }
    }

    public class EventVersusTeams
    {
        public string? Region { get; set; }
        public string? Abbreviation { get; set; }
    }

    public class ClientTeamMatchDTO
    {
        public string? EventID { get; set; }
        public string? Region { get; set; }
        public int Phase { get; set; }
        public int Score { get; set; }
    }

    private List<EventModel> _versusEvents = new();
    private List<ClientTeamMatchDTO> _liveScores = new();
    private bool _isLoading = true;
    private Timer? _refreshTimer;

    protected override async Task OnInitializedAsync()
    {
        await LoadData();
        _refreshTimer = new Timer(async _ => await InvokeAsync(LoadData), null, 3000, 3000);
    }

    private async Task LoadData()
    {
        try
        {
            var events = await apiService.GetAsync<EventModel>("/Events/Details");
            var scores = await apiService.GetAsync<ClientTeamMatchDTO>("score/TeamMatch");

            if (events != null)
            {
                _versusEvents = events
                    .Where(x => x.EventVersusList != null
                             && x.EventVersusList.Count == 2
                             && IsTeamSport(x.Sport))
                    .OrderByDescending(x => x.IsFinished == false) // Live first
                    .ThenBy(x => x.Sport)
                    .ToList();
            }

            if (scores != null)
            {
                _liveScores = scores.ToList();
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error: {ex.Message}");
        }
        finally
        {
            _isLoading = false;
            StateHasChanged();
        }
    }

    // --- LOGIC HELPERS ---

    private string GetCurrentGamePhase(string eventId, string? sport, bool isFinished)
    {
        if (isFinished || string.IsNullOrEmpty(sport)) return "";

        var eventScores = _liveScores.Where(s => s.EventID == eventId).ToList();
        if (!eventScores.Any()) return "START";

        int maxPhase = eventScores.Max(s => s.Phase);
        var s = sport.ToLower();

        if (s.Contains("basket"))
        {
            if (maxPhase <= 4) return $"Q{maxPhase}";
            if (maxPhase == 5) return "OT";
            return $"{maxPhase - 4}OT";
        }

        if (s.Contains("volley") || s.Contains("tennis") || s.Contains("badminton") || s.Contains("sepak"))
        {
            return $"SET {maxPhase}";
        }

        if (s.Contains("base") || s.Contains("soft"))
        {
            return $"INN {maxPhase}";
        }

        return "";
    }

    private (int, int) CalculateSets(string eventId, string? regionA, string? regionB, bool isMatchFinished)
    {
        int setsA = 0;
        int setsB = 0;
        var eventScores = _liveScores.Where(s => s.EventID == eventId).ToList();

        if (!eventScores.Any()) return (0, 0);

        int maxPhase = eventScores.Max(s => s.Phase);

        for (int i = 1; i <= maxPhase; i++)
        {
            if (i < maxPhase || isMatchFinished)
            {
                var scoreA = eventScores.FirstOrDefault(s => s.Region == regionA && s.Phase == i)?.Score ?? 0;
                var scoreB = eventScores.FirstOrDefault(s => s.Region == regionB && s.Phase == i)?.Score ?? 0;
                if (scoreA > scoreB) setsA++; else if (scoreB > scoreA) setsB++;
            }
        }
        return (setsA, setsB);
    }

    private int GetTeamTotalPoints(string eventId, string? region)
    {
        if (string.IsNullOrEmpty(region)) return 0;
        return _liveScores.Where(s => s.EventID == eventId && s.Region == region).Sum(s => s.Score);
    }

    private bool IsSetBasedSport(string? sport)
    {
        if (string.IsNullOrEmpty(sport)) return false;
        var s = sport.ToLower();
        return s.Contains("volley") || s.Contains("tennis") || s.Contains("badminton") || s.Contains("sepak");
    }

    private bool IsTeamSport(string? sport)
    {
        if (string.IsNullOrEmpty(sport)) return false;
        var s = sport.ToLower();
        return s.Contains("basket") || s.Contains("volley") || s.Contains("football") ||
               s.Contains("futsal") || s.Contains("soccer") || s.Contains("tennis") ||
               s.Contains("badminton") || s.Contains("sepak") || s.Contains("base") ||
               s.Contains("soft");
    }

    private string GetSportIcon(string? sport)
    {
        var s = sport?.ToLower() ?? "";
        if (s.Contains("basket")) return Icons.Material.Filled.SportsBasketball;
        if (s.Contains("volley")) return Icons.Material.Filled.SportsVolleyball;
        if (s.Contains("soccer") || s.Contains("foot") || s.Contains("futsal")) return Icons.Material.Filled.SportsSoccer;
        if (s.Contains("tennis") || s.Contains("badminton")) return Icons.Material.Filled.SportsTennis;
        if (s.Contains("base") || s.Contains("soft")) return Icons.Material.Filled.SportsBaseball;
        if (s.Contains("sepak")) return Icons.Material.Filled.SportsKabaddi;
        return Icons.Material.Filled.SportsEsports;
    }

    public void Dispose() => _refreshTimer?.Dispose();
}