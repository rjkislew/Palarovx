@page "/"

<!--
The home page where the events are listed and functions
as the dashboard for the palaro 2026 management system
-->
@using System.Net.Http
@using System.Text.Json
@using System.Threading.Tasks
@inject IDialogService DialogService
@inject APIService apiService
@inject HttpClient httpClient

<MudGrid>
    @* Sports Events *@
    <MudItem xs="12" sm="6" lg="4">
        <MudLink Href="./events" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudStack Row>
                            <MudText Style="font-size: 75px">
                                @_eventCounts?.NumberOfEvents
                            </MudText>
                            <MudDivider Vertical="true" FlexItem="true" />
                            <MudStack Justify="Justify.Center" AlignItems="AlignItems.Start" Spacing="0">
                                <MudChip T="string" Color="Color.Success" Size="Size.Small">
                                    Finished: @_eventCounts?.NumberOfFinishedEvents
                                </MudChip>
                                <MudChip T="string" Color="Color.Warning" Size="Size.Small">
                                    Ongoing: @_eventCounts?.NumberofOngoingEvents
                                </MudChip>
                                <MudChip T="string" Color="Color.Dark" Size="Size.Small">
                                    Lacking Player/s: @_eventCounts?.NumberOfEventsThatLacksPlayers
                                </MudChip>
                            </MudStack>
                        </MudStack>
                        <MudIcon Icon="@Icons.Material.Filled.Event" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>Sport Events</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    @* Players *@
    <MudItem xs="12" sm="6" lg="4">
        <MudLink Href="./profiles/players" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudStack Row Style="height: 100%">
                            <MudText Style="font-size: 75px">
                                @_eventCounts?.NumberOfPlayers
                            </MudText>
                            <MudDivider Vertical="true" FlexItem="true" />
                            <MudStack Justify="Justify.Center" AlignItems="AlignItems.Start" Spacing="0">
                                <MudChip T="string" Color="Color.Info" Size="Size.Small">
                                    Male: @_eventCounts?.NumberOfMalePlayers
                                </MudChip>
                                <MudChip T="string" Color="Color.Error" Size="Size.Small">
                                    Female: @_eventCounts?.NumberOfFemalePlayers
                                </MudChip>
                            </MudStack>
                        </MudStack>
                        <MudIcon Icon="@Icons.Material.Filled.Person" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>Players</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    @* Regional Teams *@
    <MudItem xs="12" sm="6" lg="4">
        <MudLink Href="./schools/regions" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudStack Row Style="height: 100%">
                            <MudText Style="font-size: 75px">
                                @_eventCounts?.NumberOfRegionalTeamsParticipating
                            </MudText>
                            <MudDivider Vertical="true" FlexItem="true" />
                            <MudStack Justify="Justify.Center" AlignItems="AlignItems.Start" Spacing="0">
                                <MudChip T="string" Color="Color.Dark" Size="Size.Small">
                                    Divisions: @_eventCounts?.NumberOfSchoolDivisionsParticipating
                                </MudChip>
                                <MudChip T="string" Color="Color.Dark" Size="Size.Small">
                                    Schools: @_eventCounts?.NumberOfSchoolsParticipating
                                </MudChip>
                                <MudChip T="string" Color="Color.Dark" Size="Size.Small">
                                    Coaches: @_eventCounts?.NumberOfCoaches
                                </MudChip>
                            </MudStack>
                        </MudStack>
                        <MudIcon Icon="@Icons.Material.Filled.School" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>Regional Teams</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    @* Event Venues *@
    <MudItem xs="12" sm="6" lg="3">
        <MudLink Href="./events/venues" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudText Style="font-size: 75px">
                            @_eventCounts?.NumberOfVenues
                        </MudText>
                        <MudDivider Vertical="true" FlexItem="true" />
                        <MudIcon Icon="@Icons.Material.Filled.LocationOn" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>Event Venues</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    @* Billeting Quarters *@
    <MudItem xs="12" sm="6" lg="3">
        <MudLink Href="./schools/billeting-quarters" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudText Style="font-size: 75px">
                            @_eventCounts?.NumberOfBilletingQuarters
                        </MudText>
                        <MudDivider Vertical="true" FlexItem="true" />
                        <MudIcon Icon="@Icons.Material.Filled.LocationOn" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>Billeting Quarters</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    @* News Published *@
    <MudItem xs="12" sm="6" lg="3">
        <MudLink Href="./news" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudText Style="font-size: 75px">
                            @_eventCounts?.NumberOfNewsPublished
                        </MudText>
                        <MudDivider Vertical="true" FlexItem="true" />
                        <MudIcon Icon="@Icons.Material.Filled.Newspaper" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>News Published</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    @* Event Streams *@
    <MudItem xs="12" sm="6" lg="3">
        <MudLink Href="./events/streams" Underline="Underline.None">
            <MudPaper Outlined Class="scale-up-center">
                <MudStack Class="pa-5" Style="width: 100%" AlignItems="AlignItems.Center">
                    <MudStack Row Style="height: 100%; width: 100%" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly">
                        <MudStack Row Style="height: 100%">
                            <MudText Style="font-size: 75px">
                                @_eventCounts?.NumberOfEventStreams
                            </MudText>
                            <MudDivider Vertical="true" FlexItem="true" />
                            <MudStack Justify="Justify.Center" AlignItems="AlignItems.Start" Spacing="0">
                                <MudChip T="string" Color="Color.Dark" Size="Size.Small">
                                    Stream Services: @_eventCounts?.NumberOfEventStreamServices
                                </MudChip>
                            </MudStack>
                        </MudStack>
                        <MudIcon Icon="@Icons.Material.Filled.Stream" Style="font-size: 75px" Color="Color.Dark" />
                    </MudStack>
                    <MudText>Event Streams</MudText>
                </MudStack>
            </MudPaper>
        </MudLink>
    </MudItem>

    <MudItem xs="12">
        <MudDivider/>
    </MudItem>

    <MudItem xs="12">
        <MudPaper Outlined Style="height: 35vh">
            <MudStack Row Style="background-color: #212121;height: 50px;" Class="rounded-t pa-3">
                <MudText Style="color: white">Logs</MudText>
                <MudSpacer/>
                <MudButton StartIcon="@Icons.Material.Filled.Refresh" Style="color: white"></MudButton>
            </MudStack>
            <MudStack Style="height: 100%" Class="pa-3">
            </MudStack>
        </MudPaper>
    </MudItem>
</MudGrid>

@code
{
    private IMudDialogInstance? MudDialog { get; set; }

    private EventsDTO.EventCount? _eventCounts;

    public class EventsDTO
    {
        public class EventCount
        {
            // Events
            public int? NumberOfEvents { get; set; }
            public int? NumberOfFinishedEvents { get; set; }
            public int? NumberofOngoingEvents { get; set; }
            public int? NumberOfEventsThatLacksPlayers { get; set; }

            // News
            public int? NumberOfNewsPublished { get; set; }

            // Streams
            public int? NumberOfEventStreamServices { get; set; }
            public int? NumberOfEventStreams { get; set; }

            // Venues and Billeting Quarters
            public int? NumberOfVenues { get; set; }
            public int? NumberOfBilletingQuarters { get; set; }

            // Participants
            public int? NumberOfRegionalTeamsParticipating { get; set; }
            public int? NumberOfSchoolDivisionsParticipating { get; set; }
            public int? NumberOfSchoolsParticipating { get; set; }
            public int? NumberOfPlayers { get; set; }
            public int? NumberOfMalePlayers { get; set; }
            public int? NumberOfFemalePlayers { get; set; }
            public int? NumberOfCoaches { get; set; }
        }
    }

    protected override async Task OnInitializedAsync()
    {
        await GetCounterAsync();
    }

    private async Task GetCounterAsync()
    {
        string url = "/Counter";
        _eventCounts = await apiService.GetSingleAsync<EventsDTO.EventCount>(url);
    }
}
